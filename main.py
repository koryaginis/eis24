# Суть подхода такая: для каждого пользователя я собираю множество страниц,
# которые он посещал в первый день, и множество страниц за второй день.
# Данные беру из CSV через pandas.read_csv, затем использую groupby и agg(set),
# чтобы получить по пользователю именно множество уникальных страниц.
# Дальше я оставляю только тех пользователей, которые встречаются в обоих днях
# (index.intersection), потому что сравнивать есть смысл только их.
# Если множества страниц за два дня для пользователя совпадают полностью,
# значит он в оба дня ходил по одному и тому же набору страниц и нового
# интереса не проявлял. Если же хотя бы одна страница есть только в одном
# из дней (то есть S1 - S2 или S2 - S1 не пусты), значит в один из дней он
# посмотрел что-то новое, значит его интерес изменился. Это мы проверяем
# через операции разности множеств (-) и функцию len().

import pandas as pd

d1 = pd.read_csv("1st_day.csv")  # cols: user, page
d2 = pd.read_csv("2nd_day.csv")

u1_pages = d1.groupby("user")["page"].agg(set)
u2_pages = d2.groupby("user")["page"].agg(set)

common_users = u1_pages.index.intersection(u2_pages.index)

def has_diff_pages(user):
    s1, s2 = u1_pages[user], u2_pages[user]
    # проверяем, есть ли хотя бы одна страница, которая отличается
    return len(s1 - s2) > 0 or len(s2 - s1) > 0

loyal_users = [u for u in common_users if has_diff_pages(u)]
print(loyal_users)